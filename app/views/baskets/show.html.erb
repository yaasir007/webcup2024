<h1>This is Basket</h1>

<% if @items.empty? %>

  <div class="container">
    <div class="row">
      <div class="col-12">
        <p>Your basket is empty</p>
      </div>
    </div>
  </div>

<% else %>
  <div class="container">
    <% @items.each do |item| %>
      <div class="row">
        <div class="col-12">
          <h2><%= item.product.title %></h2>
          <p><%= item.product.description %></p>
          <p><strong>Price:</strong> <%= number_to_currency(item.product.price) %></p>
          <p>Quantity: <%= item.quantity %></p>
          <%= simple_form_for item, url: basket_item_path(item), method: :delete do |f| %>
            <%= f.submit "Remove from basket", class: "btn btn-danger" %>
          <% end %>
        </div>
      </div>
    <% end %>

    <p>Total: <%= total_price(@basket) %></p>
  </div>

  <div class="container mb-5">
    <%= simple_form_for @order, data: { controller: 'delivery-location', action: "delivery-location#sendPickupCoordinates", delivery_location_api_key_value: "#{ENV['MAPBOX_API_KEY']}" } do |f| %>
        <div  style="width: 100%; height: 500px;"
                  data-delivery-location-target="map"></div>
      <%= f.input :latitude, as: :hidden, input_html: { data: { delivery_location_target: "latitude" } } %>
      <%= f.input :longitude, as: :hidden, input_html: { data: { delivery_location_target: "longitude" } } %>
      <%= f.submit 'Checkout'  %>
    <% end %>
  </div>
<% end %>
